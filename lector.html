<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nexus Avatar</title>

    <link rel="preload" href="./fonts/barlow-condensed-v13-latin-regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="./fonts/material-icons-v145-latin-regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    <link rel="preload" href="./fonts/barlow-condensed-v13-latin-700.woff2" as="font" type="font/woff2" crossorigin="anonymous">
	<link rel="preload" href="./fonts/material-icons-round-v109-latin-regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
    

    <link rel="stylesheet" href="estilos-nexus.css"> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://proc3r.github.io/nexus/">
    <meta property="og:title" content="Nexus Avatar - Lector de Manuscritos">
    <meta property="og:description" content="Explora la biblioteca de documentos y manuscritos sincronizados.">
    <meta property="og:image" content="https://raw.githubusercontent.com/proc3r/001-Publicados/refs/heads/master/adjuntos/PortadaBase.jpg">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://proc3r.github.io/nexus/">
    <meta property="twitter:title" content="Nexus Avatar - Lector de Manuscritos">
    <meta property="twitter:description" content="Explora la biblioteca de documentos y manuscritos sincronizados.">
    <meta property="twitter:image" content="https://raw.githubusercontent.com/proc3r/001-Publicados/refs/heads/master/adjuntos/PortadaBase.jpg">

    <link rel="manifest" href="manifest.json"> 
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="dns-prefetch" href="https://wsrv.nl">
    <link rel="preconnect" href="https://wsrv.nl">

    <style>
        /* Estilo cr√≠tico preventivo */
        body { font-family: 'Barlow Condensed', sans-serif; }
    </style>  
<body>

 <div id='welcome-portal' class="portal-wrapper">
    <div class='portal-box'>
        <p class="notranslate portal-footer">Choose a language to enter</p>
        
        

        <div class="portal-grid">
			<button id="btn-portal-es" class="portal-btn btn-es" onclick="seleccionarIdiomaInicio('es')">
				<span class="portal-flag">üá™üá∏</span> ESPA√ëOL (ORIGINAL)
			</button>
            <button class="portal-btn btn-en" onclick="seleccionarIdiomaInicio('en')">
                <span class="portal-flag">üá∫üá∏</span> ENGLISH
            </button>
            <button class="portal-btn btn-zh" onclick="seleccionarIdiomaInicio('zh-CN')">
                <span class="portal-flag">üá®üá≥</span> ÁÆÄ‰Ωì‰∏≠Êñá
            </button>
            <button class="portal-btn btn-hi" onclick="seleccionarIdiomaInicio('hi')">
                <span class="portal-flag">üáÆüá≥</span> ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä
            </button>
            <button class="portal-btn btn-de" onclick="seleccionarIdiomaInicio('de')">
                <span class="portal-flag">üá©üá™</span> DEUTSCH
            </button>
        </div>

        <p class="notranslate portal-footer" style="margin-top: 3%;">Other Languages</p>
        <div id='google_portal_element'></div> 
    </div>
</div>


<div id="auto-loader" class="nexus-splash-container">
    <div class="splash-layout">
        <div class="section-top">
            <h1 class="logo-container notranslate">
                <span class="logo-text1">NE</span><span class="logo-text2">X</span><span class="logo-text3">US</span>
            </h1>
        </div>

        <div class="section-center">
            <div class="loader-wrapper">
                <img src="./moon.png" class="splash-logo-img">
                <div class="loader-circle"></div>
            </div>
            <p id="loader-book-title" class="splash-subtitle">MODELO NOUMENICO</p>
        </div>

        <div class="section-bottom">
            <p class="splash-status-2">BUSCANDO SECCI√ìN</p>
        </div>
    </div>
</div>

			


	<div id="reader-view" class="hidden book-container dark-mode">
    <div id="sidebar-trigger" onmouseenter="openSidebar()" onclick="openSidebar()">
        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7"/></svg>
    </div>
    
    <aside id="reader-sidebar" class="custom-scrollbar" onmouseleave="handleSidebarLeave()">
        <div class="sidebar-header" style="padding: 0; display: flex; flex-direction: column;">
            <div id="sidebar-cover-preview" class="w-full h-48 relative overflow-hidden border-b border-white/10 shadow-lg flex-shrink-0">
                <div class="absolute inset-0 bg-black/40"></div>
                <div class="px-2.5 pb-4 pt-1 flex flex-col justify-between h-full relative z-10">
                    <div class="flex justify-between pb-0.5 items-start">
                        <button onclick="closeReader()" class="mi-round text-[40px] text-[#ffffff] notranslate" style="
								animation: pause-tts 3s infinite ease-in-out;">home</button>
                        <div class="flex items-center px-3 gap-4 bg-black/40 backdrop-blur-sm p-1 rounded-lg border border-white/10">
                            <button id="expand-mode-btn" onclick="toggleExpandMode()" class="mi-round text-lg text-[#ffffff] notranslate">expand</button>
                            
							
							<button id="pin-btn" onclick="togglePin()" class="text-gray-300 opacity-90 hover:opacity-100">üìå</button>
                            <button onclick="closeSidebar()" class="text-[#ffcc00] hover:text-white">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                            </button>
                        </div>
                    </div>
                    <h2 id="reader-title" class="text-[2rem] font-bold text-white condensed italic leading-none drop-shadow-md pb-2 ">
                        T√≠tulo del Libro
                    </h2>
					
					<div id="youtube-player" class="yt-hidden-player"></div>

<div id="soundtrack-widget" class="soundtrack-card">
    <div class="soundtrack-controls">
        <button onclick="toggleSoundtrack()" id="btn-music-main" class="music-toggle-btn">
            <span id="music-icon" class="material-icons-round notranslate">play_arrow</span>
        </button>

        <div class="soundtrack-info">
            <div class="soundtrack-header-row">
                <p id="music-status-text" class="status-label-yt">Esperando pista...</p>
                <span class="soundtrack-label-inline">AMBIENTE SONORO</span>
            </div>
            
            <div class="volume-wrapper">
                <input type="range" id="music-volume" min="0" max="100" value="30" 
       oninput="globalVolumeControl(this.value, this.id)" class="nexus-slider">
            </div>
        </div>
    </div>
</div>

                </div>
            </div>


        </div>
        
        <div id="chapter-list" class="sidebar-content custom-scrollbar" style="text-shadow: 0.5px 0.5px 1px rgb(103 106 105); flex-grow: 1;"></div>
    </aside>



<main class="reader-main-layout">
    <div id="image-timer" class="hidden">
        <span id="timer-text" class="image-timer text-[#ffffff]">La lectura se reanudar√° en 5s</span>
        <button onclick="togglePauseImageTimer()" class="timer-pause-btn text-[#ffffff]">Pausar</button>
    </div>
    <nav class="h-8 flex-shrink-0 flex items-center justify-between px-2 sm:px-4 border-b-4 border-blue-500 bg-black/20 backdrop-blur-md relative z-50">
        <button onclick="closeReader()" class="text-[#ffcc00] font-bold uppercase text-[23px] tracking-[0.02em] condensed flex items-center gap-1 hover:text-white transition-colors notranslate" style="text-shadow: -1px 1px 5px rgb(0 0 0 / 79%);">
            <h1 class="logo-container2 notranslate"><span class="logo-text1">NE</span><span class="logo-text2">X</span><span class="logo-text3">US</span></h1>
        </button>
        <div class="flex items-center gap-1.5 md:gap-4">
            <div class="flex items-center bg-white/5 rounded-full px-2 py-0.5 gap-1 md:gap-4  font-bold border border-white/5 text-[14px] notranslate">
                <button onclick="changeFontSize(-2)" class="hover:text-[#ffcc00]" title="Disminuir Fuente">A-</button>
                <span id="font-size-val">25</span>
                <button onclick="changeFontSize(2)" class="hover:text-[#ffcc00]" title="Aumentar Fuente">A+</button>
            </div>
            <div class="settings-dropdown-container notranslate">
                <button onclick="toggleDropdown('font-dropdown')" class="nav-icon-btn notranslate" title="Cambiar Fuente">
                    <span class="mi-round text-lg">text_fields</span>
                </button>
                <div id="font-dropdown" class="settings-dropdown font-dropdown custom-scrollbar">
                    <div class="setting-option" style="font-family: 'Merriweather'" onclick="changeFontFamily('Merriweather')">Merriweather</div>
                    <div class="setting-option" style="font-family: 'Lora'" onclick="changeFontFamily('Lora')">Lora</div>
                    <div class="setting-option" style="font-family: 'Inter'" onclick="changeFontFamily('Inter')">Inter</div>
                    <div class="setting-option" style="font-family: 'Atkinson Hyperlegible'" onclick="changeFontFamily('Atkinson Hyperlegible')">Hyperlegible</div>
                </div>
            </div>

            <div class="settings-dropdown-container">
                <button onclick="toggleDropdown('align-dropdown')" class="nav-icon-btn notranslate" title="Alineaci√≥n">
                    <span class="mi-round text-lg">format_align_center</span>
                </button>
                
				
				<div id="align-dropdown" class="settings-dropdown">
					<div id="option-align-left" class="setting-option" onclick="changeAlignment('left')">
						<span class="mi-round text-base notranslate">format_align_left</span> Izquierda
					</div>
					<div id="option-align-right" class="setting-option hidden" onclick="changeAlignment('right')">
						<span class="mi-round text-base notranslate">format_align_right</span> Derecha
					</div>
					<div class="setting-option selected" onclick="changeAlignment('center')">
						<span class="mi-round text-base notranslate">format_align_center</span> Centro
					</div>
					<div class="setting-option" onclick="changeAlignment('justify')">
						<span class="mi-round text-base notranslate">format_align_justify</span> Justificado
					</div>
				</div>


            </div>

            <div class="settings-dropdown-container">
                <button onclick="toggleDropdown('spacing-dropdown')" class="nav-icon-btn notranslate" title="Interlineado">
                    <span class="mi-round text-lg">format_line_spacing</span>
                </button>
                <div id="spacing-dropdown" class="settings-dropdown">
                    <div class="setting-option selected" onclick="changeLineHeight(1.3)">
                        <span class="mi-round text-base notranslate">reorder</span> Compacto
                    </div>
                    <div class="setting-option" onclick="changeLineHeight(1.5)">
                        <span class="mi-round text-base notranslate">notes</span> Normal
                    </div>
                    <div class="setting-option" onclick="changeLineHeight(1.8)">
                        <span class="mi-round text-base notranslate">subject</span> Extenso
                    </div>
                </div>
            </div>

            <button onclick="toggleDarkMode()" class="nav-icon-btn notranslate" title="Modo Color">üåì</button>
			<button aria-label='Traducir P√°gina' class='translate-toggle show-translate btn notranslate'></button>
		
		</div>
    </nav>

    <div id="chapter-indicator-container" class="flex-shrink-0 flex justify-center w-full pointer-events-none z-10 -mt-0.5">
    <div id="chapter-indicator" class="truncate">
        Cap√≠tulo
    </div>
</div>
    
    <button id="zen-mode-btn" class="zen-btn-mobile" onclick="toggleZenMode()">
        <span class="material-icons notranslate" id="zen-icon">fullscreen</span>
    </button>
	
	<button id="refresh-voice-btn" class="refresh-voice-btn" onclick="refreshSpeech()">
    <span class="material-icons notranslate" style="line-height: 1.8;">refresh</span>
</button>
    
	<div id="reading-help-toast" class="reading-toast">
    <span class="toast-text">¬øTraducci√≥n err√≥nea? Pulsa</span>
    <span class="material-icons toast-icon notranslate">refresh</span>

</div>

    <div id="reading-container-fixed" class="custom-scrollbar">
        <div class="content-wrapper">
            <div class="max-w-4xl mx-auto w-full">
                <div id="book-content"></div>
            </div>
        </div>
    </div>



    <footer class="flex-shrink-0 px-4 py-1 border-t border-white/10 bg-black/15" style="position: relative;">
    <div id="visual-timer-wrapper" class="hidden">
        <span id="visual-timer-concept">@2</span>
        <div id="visual-timer-fill"></div>
    </div>

    <div class="max-w-4xl mx-auto">
        <div class="zen-hide-group">
			
			
			
                <div class="flex flex-col mb-1 condensed tracking-widest leading-none">
					<div class="flex justify-between items-end text-[18px] italic">
						<div>
							<span style="letter-spacing: 0.2px;">P√ÅRRAFO:</span> 
							<span class="notranslate" style="font-weight: bold; letter-spacing: 0.4px;">
								<span id="current-p-num">0</span> / <span id="total-p-num">0</span>
							</span>
						</div>
						
						<span id="progress-percent" class="notranslate font-bold">0%</span>
					</div>
					<div id="time-remaining" class="text-[16px] italic opacity-90 mb-[1px] uppercase" style="letter-spacing: 0.5px;">
						Calculando tiempo...
					</div>
				</div>
				
				
                <div class="progress-bar-container mb-3">
                    <div id="reading-progress-bar"></div>
                    <div id="progress-markers-container"></div>
                </div>
							
                <div class="flex justify-between items-center pb-2.5 notranslate">
                    <button onclick="prevChunk()" class="btn-nav btn-back">‚óÄ BACK</button>
                    <div class="flex items-center gap-2">
                        <button id="btn-volume-yt" onclick="toggleVolumePopover(event)" class="btn-volume-nexus">
                            <span id="volume-icon-yt" class="material-icons-round">music_note</span>
                        </button>
                        <div class="relative">
                            <div id="reader-speed-menu" class="speed-menu-up hidden">
                                <button onclick="setReaderSpeed(0.9)">0.9x</button>
                                <button onclick="setReaderSpeed(1.0)">1.0x</button>
                                <button onclick="setReaderSpeed(1.1)">1.1x</button>
                                <button onclick="setReaderSpeed(1.2)">1.2x</button>
                                <button onclick="setReaderSpeed(1.3)">1.3x</button>
                                <button onclick="setReaderSpeed(1.4)">1.4x</button>
                            </div>
                            <button id="btn-reader-speed" onclick="toggleReaderSpeedMenu(event)" class="btn-speed">
                                <span id="reader-speed-label">1.0x</span>
                            </button>
                        </div>
                        <button id="share-btn" onclick="shareCurrentPoint()" class="btn-share-nexus">
                            <span class="material-icons-round">share</span>
                        </button>
                    </div>
                    <button id="next-btn" onclick="nextChunk()" class="btn-nav btn-next">NEXT ‚ñ∂</button>
                </div>
            </div>

            
        </div>
    </footer>
	
<div class="reader-controls-wrapper">
    <div class="main-audio-trigger">
        <button id="stop-btn" onclick="stopSpeech()" class="btn-float-stop hidden">
            <span class="material-icons notranslate">stop</span>
        </button>

        <button id="tts-btn" onclick="startSpeech()" class="btn-float-red">
            <span class="material-icons notranslate">play_arrow</span>
        </button>
        
        <button id="pause-btn" onclick="pauseSpeech()" class="btn-float-pause hidden" title="Pausar lectura">
            <span id="pause-icon" class="material-icons notranslate">pause</span>
        </button>

        <button id="voice-vol-btn" onclick="toggleVoiceStack(event)" class="btn-ttsvolume-nexus hidden">
            <span class="material-icons notranslate">volume_up</span>
        </button>
    </div>
</div>
	
	
	
</main>
	
			
        </div>
    </div>
	

<!--  PANTALLA PARA COMPARTIR -->
<div id="image-modal" class="image-modal hidden" onclick="closeImageModal()">
    <span class="close-modal-btn">&times;</span>
    <div class="modal-content-wrapper" onclick="event.stopPropagation()">
        <img id="modal-image" src="" alt="Imagen HD">
        <div id="modal-caption" class="modal-caption"></div>
    </div>
</div>

<div id="share-modal" class="share-modal-overlay hidden">
    <div id="share-modal-content" class="share-modal-container">
        
        <div class="share-header">
            <img id="share-book-img" src="" alt="Portada">
            <div class="share-header-gradient"></div>
            <div class="share-title-container notranslate">
                <div class="share-grid">
                <button onclick="executeShare('whatsapp')" class="share-icon-item group" title="WhatsApp">
                    <div class="icon-wrapper wa-bg"><i class="fab fa-whatsapp"></i></div>
                </button>
                <button onclick="executeShare('x')" class="share-icon-item group" title="Twitter">
                    <div class="icon-wrapper x-bg"><i class="fa-brands fa-x-twitter"></i> </div>
                </button>
                <button onclick="executeShare('telegram')" class="share-icon-item group" title="Telegram">
                    <div class="icon-wrapper tg-bg"><i class="fab fa-telegram-plane"></i></div>
                </button>
                <button onclick="executeShare('linkedin')" class="share-icon-item group"title="LinkedIn">
                    <div class="icon-wrapper in-bg"><i class="fab fa-linkedin-in"></i></div>
                </button>
                <button onclick="executeShare('email')" class="share-icon-item group"title="Email">
                    <div class="icon-wrapper mail-bg"><span class="material-icons-round">email</span></div>
                </button>
                <button onclick="executeShare('copy')" class="share-icon-item group"title="Link">
                    <div class="icon-wrapper link-bg"><span class="material-icons-round">link</span></div>
                </button>
				<button onclick="executeShare('facebook')" class="share-icon-item group" title="Facebook">
					<div class="icon-wrapper fb-bg"><i class="fab fa-facebook-f"></i></div>
				</button>
				<button onclick="executeShare('reddit')" class="share-icon-item group" title="Reddit">
					<div class="icon-wrapper reddit-bg"><i class="fab fa-reddit-alien"></i></div>
				</button>
            </div>
            </div>
        </div>
<div class="share-preview-container">
    <h4 id="share-book-title">T√≠tulo del Libro</h4>
    <p class="share-subtitle">Compartir en Redes</p>
    <div class="share-text-content">
        <p id="share-text-preview"></p>
    </div>
</div>
        <div class="share-body">
		<button onclick="closeShareModal()" class="share-close-btn notranslate">
                <span class="material-icons-round">close</span>
            </button>
            
        </div>
    </div>
</div>


<div id="volume-sidebar-container" class="volume-sidebar hidden">
    <div class="volume-sidebar-glass">
        <span class="material-icons-round volume-side-icon notranslate">volume_up</span>
        <div class="slider-wrapper">
            <input type="range" id="music-volume-sync" min="0" max="100" value="30" 
                   oninput="globalVolumeControl(this.value, this.id)" class="nexus-slider-vertical">
        </div>
        <span class="material-icons-round volume-side-icon notranslate">volume_off</span>
    </div>
</div>

<div id="voice-volume-sidebar" class="volume-sidebar hidden">
    <div class="volume-sidebar-glass voice-theme">
        <span class="material-icons-round volume-side-icon notranslate">record_voice_over</span>
        <div class="slider-wrapper">
            <input type="range" id="voice-volume-sync" min="0" max="1" step="0.1" value="1" 
                   oninput="controlVoiceVolume(this.value)" class="nexus-slider-vertical voice-slider">
        </div>
        <span class="material-icons-round volume-side-icon notranslate">volume_mute</span>
    </div>
</div>


<div id='translate-overlay' style='display: none;'>
    <div class='overlay-content'>
        <button id="btn-restore-original" class="portal-btn btn-es notranslate" onclick="restaurarOriginalYRefrescar()" style="width: 100%;">
            <span class="portal-flag">üá™üá∏</span> MOSTRAR ORIGINAL (ESPA√ëOL)
        </button>

        <p class="notranslate portal-footer" style="margin-bottom: 10px;">Quick Selection</p>
        
        <div class="portal-grid">
            <button class="portal-btn btn-en" onclick="cambiarIdiomaDinamicamente('en')">
                <span class="portal-flag">üá∫üá∏</span> ENGLISH
            </button>
            <button class="portal-btn btn-zh" onclick="cambiarIdiomaDinamicamente('zh-CN')">
                <span class="portal-flag">üá®üá≥</span> ÁÆÄ‰Ωì‰∏≠Êñá
            </button>
            <button class="portal-btn btn-hi" onclick="cambiarIdiomaDinamicamente('hi')">
                <span class="portal-flag">üáÆüá≥</span> ‡§π‡§ø‡§®‡•ç‡§¶‡•Ä
            </button>
            <button class="portal-btn btn-de" onclick="cambiarIdiomaDinamicamente('de')">
                <span class="portal-flag">üá©üá™</span> DEUTSCH
            </button>
        </div>

        <p class="notranslate portal-footer" style="margin-top: 3%;">Other Languages</p>
        <div id='google_translate_element'></div>

        <button id='close-translate-overlay' onclick="closeTranslateModal()">
            <span class="material-icons notranslate">close</span>
        </button>
    </div>
</div>


<div id="nexus-translation-store" style="display:none;" aria-hidden="true">
    <span id="store-comenzando">Comenzando en </span>
    <span id="store-pausado">Pausado. Presione REANUDAR o NEXT.</span>
    <span id="store-btn-pausar">Pausar</span>
    <span id="store-btn-reanudar">Reanudar</span>
</div>



<script src="https://www.youtube.com/iframe_api"></script>



   
    <script>
        // 1. Indicamos al Core que este es el lector externo
        window.isLectorFijo = true;
		
		/**
 * PUENTE DE COMPATIBILIDAD PARA EL LECTOR
 * Redirige la llamada del slider de volumen del HTML a la funci√≥n global.
 */
function changeVolume(value) {
    // 1. Llamamos a la funci√≥n que ya tienes en soundtrack.js
    // El segundo par√°metro es el ID del slider para que se sincronice visualmente
    if (typeof globalVolumeControl === 'function') {
        globalVolumeControl(value, 'music-volume-sync');
    } else {
        // 2. Si por alguna raz√≥n la funci√≥n global no est√°, 
        // intentamos hablar directamente con el player de YouTube
        if (typeof player !== 'undefined' && player && player.setVolume) {
            player.setVolume(value);
        }
    }
}

    // --- INTERCEPTOR SMART LINK ---
    (function() {
        const urlParams = new URLSearchParams(window.location.search);
        const smartParam = urlParams.get('s');

        if (smartParam) {
            try {
                const decoded = decodeURIComponent(smartParam);
                const parts = decoded.split('|');
                
                if (parts.length === 4) {
                    const repo = parts[0];
                    const book = parts[1].replace(/_/g, ' ') + '.md';
                    const ch = parts[2];
                    const ck = parts[3];

                    // RE-INYECCI√ìN: Creamos nuevos par√°metros en la URL virtualmente
                    // para que el resto de tus scripts sigan leyendo repo, book, ch y ck como siempre.
                    const newRelativePathQuery = window.location.pathname + `?repo=${repo}&book=${encodeURIComponent(book)}&ch=${ch}&ck=${ck}`;
                    window.history.replaceState(null, '', newRelativePathQuery);
                    
                    console.log("Smart Link procesado y convertido a par√°metros est√°ndar.");
                }
            } catch (e) {
                console.error("Error procesando Smart Link:", e);
            }
        }
    })();



    </script>
	
<script src="nexus-function.js" defer></script>
<script src="soundtrack.js" defer></script>
<script src="https://www.youtube.com/iframe_api"></script>

<script src="traductor.js" defer></script>
<script src="vocal-language.js" defer></script> <script src="nexus-voice.js" defer></script>
<script src="nexus-podcast.js" defer></script>
<script src="nexus-synopsis.js" defer></script>

<script src="nexus-core.js" defer></script>

</body>
</html>